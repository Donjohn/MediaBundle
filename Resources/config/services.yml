services:
    _defaults:
        autowire: true
        autoconfigure: true
        public: false

    Donjohn\MediaBundle\:
        resource: '%kernel.root_dir%/../src/Donjohn/MediaBundle/*'
        exclude: '%kernel.root_dir%/../src/Donjohn/MediaBundle/{Controller,Model,DependencyInjection}'

    Donjohn\MediaBundle\Event\Subscriber\MediaSubscriber:
        tags:
            - { name: doctrine.event_subscriber }

    _instanceof:
        Donjohn\MediaBundle\Provider\ProviderInterface:
            tags:
                - { name: media.provider }

    Donjohn\MediaBundle\Provider\Factory\ProviderFactory:
        arguments:
            $config: "%donjohn.media.providers.config%"

    Donjohn\MediaBundle\Provider\FileProvider:
        arguments:
            $uploadFolder: "%donjohn.media.upload_folder%"
            $fileMaxSize: "%donjohn.media.file_max_size%"

    Donjohn\MediaBundle\Provider\ImageProvider:
        arguments:
            $uploadFolder: "%donjohn.media.upload_folder%"
            $fileMaxSize: "%donjohn.media.file_max_size%"

    Donjohn\MediaBundle\Form\Type\:
        resource: '%kernel.root_dir%/../src/Donjohn/MediaBundle/Form/Type/*'
        arguments:
            $classMedia: "%donjohn.media.entity%"

    Donjohn\MediaBundle\Form\Type\MediaFineUploaderType:
        arguments:
            $classMedia: "%donjohn.media.entity%"
            $chunkSize: "%donjohn.media.chunk_size%"

    Donjohn\MediaBundle\Filesystem\MediaLocalFilesystem:
        arguments:
            $webFolder: "%assetic.write_to%"

    Twig_Extensions_Extension_Text:
       class: Twig_Extensions_Extension_Text

    Twig_Extensions_Extension_Intl:
        class: Twig_Extensions_Extension_Intl

    Donjohn\MediaBundle\Uploader\Naming\OriginalNamer:
        public: true

    Donjohn\MediaBundle\Event\Listener\ApiListener:
        arguments:
            $classMedia: "%donjohn.media.entity%"
        tags:
            - { name: kernel.event_listener, event: kernel.view,  priority: 33 }
